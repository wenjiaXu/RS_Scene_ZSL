opt: Namespace(IoU_scale=1.4, IoU_thr=0.5, KNOW_BIRD_BB=False, additional_loss=True, all=False, attention_K=3, attri=0.01, attri_dim=98, avg_pool=False, awa_finetune=False, batch_size=64, beta1=0.5, calibrated_stacking=0.7, checkpointroot='./checkpoint', class_embedding='att', class_embedding_path='/home/xwj/data/2023_code/RS_ZSL/data/RSSDIVCS/files/ann_attr_finetune_52_splits.mat', classifier_lr=1e-06, cpt=1e-09, cuda=True, dataroot='./data', dataset='RSSDIVCS', gzsl=False, image_embedding='res101', image_embedding_path='/home/xwj/data/2023_code/RS_ZSL/data/RSSDIVCS/files/52_images.mat', image_root='/home/xwj/data/2023_code/RS_ZSL/data/RSSDIVCS/', image_type='test_unseen_loc', l_attri=0.08, l_regular=0.0, l_xe=1.0, lasso=False, manualSeed=3866, matdataset=True, max_area_center=False, n_batch=300, nepoch=30, ol=False, out_of_edge=False, preprocessing=True, pretrain_classifier='', pretrain_epoch=4, pretrain_lr=0.0001, pretrained=None, pro_size=3, pro_start_epoch=-1, pro_thr=1.0, pro_type=4, pro_weight=1, proto_warm=2, random_id=0, regular=0.0, resize_WH=False, resnet_path='./pretrained_models/resnet101_c.pth.tar', root='./', save_att=False, sel_res='layer', shots=3, standardization=False, train_id=123, train_mode='distributed', transform_mode='normal', use_group=True, use_proposal=False, validation=False, version=1, ways=8, xe=1.0, xe_pro=1.0)
Random Seed:  3866
feature.shape (56000, 2048)
attribute.shape: torch.Size([70, 98])
Create Model...
Train and test...

 2023-05-13 23:10:45 Training epoch 0
acc_final_all:46.1% acc_final_avg:46.1%
acc_layer_all:58.9% acc_layer_avg:58.9%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 0 Batch 300] ZSL test accuracy is 58.9%, Best_acc [58.9% | Epoch-0]

[Epoch 0, Batch   300] Train loss: 7.818 

 2023-05-13 23:13:35 Training epoch 1
acc_final_all:45.6% acc_final_avg:45.6%
acc_layer_all:62.2% acc_layer_avg:62.2%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 1 Batch 300] ZSL test accuracy is 62.2%, Best_acc [62.2% | Epoch-1]

[Epoch 1, Batch   300] Train loss: 7.802 

 2023-05-13 23:16:30 Training epoch 2
acc_final_all:50.8% acc_final_avg:50.8%
acc_layer_all:61.5% acc_layer_avg:61.4%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 2 Batch 300] ZSL test accuracy is 61.4%, Best_acc [62.2% | Epoch-1]

[Epoch 2, Batch   300] Train loss: 7.785 

 2023-05-13 23:19:22 Training epoch 3
acc_final_all:52.8% acc_final_avg:52.8%
acc_layer_all:63.4% acc_layer_avg:63.4%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 3 Batch 300] ZSL test accuracy is 63.4%, Best_acc [63.4% | Epoch-3]

[Epoch 3, Batch   300] Train loss: 7.771 

 2023-05-13 23:22:00 Training epoch 4
acc_final_all:55.1% acc_final_avg:55.1%
acc_layer_all:59.7% acc_layer_avg:59.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 4 Batch 300] ZSL test accuracy is 59.7%, Best_acc [63.4% | Epoch-3]

[Epoch 4, Batch   300] Train loss: 7.755 

 2023-05-13 23:23:18 Training epoch 5
acc_final_all:59.4% acc_final_avg:59.4%
acc_layer_all:59.6% acc_layer_avg:59.6%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 5 Batch 300] ZSL test accuracy is 59.6%, Best_acc [63.4% | Epoch-3]

[Epoch 5, Batch   300] Train loss: 7.690 

 2023-05-13 23:24:41 Training epoch 6
acc_final_all:55.9% acc_final_avg:55.9%
acc_layer_all:58.7% acc_layer_avg:58.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 6 Batch 300] ZSL test accuracy is 58.7%, Best_acc [63.4% | Epoch-3]

[Epoch 6, Batch   300] Train loss: 7.616 

 2023-05-13 23:26:05 Training epoch 7
acc_final_all:56.7% acc_final_avg:56.7%
acc_layer_all:58.7% acc_layer_avg:58.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 7 Batch 300] ZSL test accuracy is 58.7%, Best_acc [63.4% | Epoch-3]

[Epoch 7, Batch   300] Train loss: 7.571 

 2023-05-13 23:27:25 Training epoch 8
acc_final_all:61.5% acc_final_avg:61.5%
acc_layer_all:62.7% acc_layer_avg:62.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 8 Batch 300] ZSL test accuracy is 62.7%, Best_acc [63.4% | Epoch-3]

[Epoch 8, Batch   300] Train loss: 7.536 

 2023-05-13 23:28:45 Training epoch 9
acc_final_all:60.2% acc_final_avg:60.2%
acc_layer_all:62.1% acc_layer_avg:62.1%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 9 Batch 300] ZSL test accuracy is 62.1%, Best_acc [63.4% | Epoch-3]

[Epoch 9, Batch   300] Train loss: 7.511 

 2023-05-13 23:30:10 Training epoch 10
acc_final_all:58.0% acc_final_avg:58.0%
acc_layer_all:62.0% acc_layer_avg:62.0%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 10 Batch 300] ZSL test accuracy is 62.0%, Best_acc [63.4% | Epoch-3]

[Epoch 10, Batch   300] Train loss: 7.492 

 2023-05-13 23:31:34 Training epoch 11
acc_final_all:59.3% acc_final_avg:59.3%
acc_layer_all:63.4% acc_layer_avg:63.4%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 11 Batch 300] ZSL test accuracy is 63.4%, Best_acc [63.4% | Epoch-3]

[Epoch 11, Batch   300] Train loss: 7.474 

 2023-05-13 23:32:56 Training epoch 12
acc_final_all:56.4% acc_final_avg:56.4%
acc_layer_all:60.7% acc_layer_avg:60.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 12 Batch 300] ZSL test accuracy is 60.7%, Best_acc [63.4% | Epoch-3]

[Epoch 12, Batch   300] Train loss: 7.460 

 2023-05-13 23:34:14 Training epoch 13
acc_final_all:56.4% acc_final_avg:56.4%
acc_layer_all:61.7% acc_layer_avg:61.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 13 Batch 300] ZSL test accuracy is 61.7%, Best_acc [63.4% | Epoch-3]

[Epoch 13, Batch   300] Train loss: 7.445 

 2023-05-13 23:35:39 Training epoch 14
acc_final_all:56.9% acc_final_avg:56.9%
acc_layer_all:62.3% acc_layer_avg:62.3%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 14 Batch 300] ZSL test accuracy is 62.3%, Best_acc [63.4% | Epoch-3]

[Epoch 14, Batch   300] Train loss: 7.438 

 2023-05-13 23:37:04 Training epoch 15
acc_final_all:56.2% acc_final_avg:56.2%
acc_layer_all:61.8% acc_layer_avg:61.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 15 Batch 300] ZSL test accuracy is 61.7%, Best_acc [63.4% | Epoch-3]

[Epoch 15, Batch   300] Train loss: 7.429 

 2023-05-13 23:38:28 Training epoch 16
acc_final_all:56.5% acc_final_avg:56.5%
acc_layer_all:61.3% acc_layer_avg:61.3%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 16 Batch 300] ZSL test accuracy is 61.3%, Best_acc [63.4% | Epoch-3]

[Epoch 16, Batch   300] Train loss: 7.421 

 2023-05-13 23:39:45 Training epoch 17
acc_final_all:54.2% acc_final_avg:54.2%
acc_layer_all:60.1% acc_layer_avg:60.1%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 17 Batch 300] ZSL test accuracy is 60.1%, Best_acc [63.4% | Epoch-3]

[Epoch 17, Batch   300] Train loss: 7.415 

 2023-05-13 23:41:08 Training epoch 18
acc_final_all:52.0% acc_final_avg:52.0%
acc_layer_all:57.2% acc_layer_avg:57.2%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 18 Batch 300] ZSL test accuracy is 57.2%, Best_acc [63.4% | Epoch-3]

[Epoch 18, Batch   300] Train loss: 7.403 

 2023-05-13 23:42:32 Training epoch 19
acc_final_all:53.7% acc_final_avg:53.7%
acc_layer_all:57.0% acc_layer_avg:57.0%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 19 Batch 300] ZSL test accuracy is 57.0%, Best_acc [63.4% | Epoch-3]

[Epoch 19, Batch   300] Train loss: 7.396 

 2023-05-13 23:43:57 Training epoch 20
acc_final_all:55.3% acc_final_avg:55.3%
acc_layer_all:59.3% acc_layer_avg:59.3%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 20 Batch 300] ZSL test accuracy is 59.3%, Best_acc [63.4% | Epoch-3]

[Epoch 20, Batch   300] Train loss: 7.401 

 2023-05-13 23:45:15 Training epoch 21
acc_final_all:53.3% acc_final_avg:53.3%
acc_layer_all:57.9% acc_layer_avg:57.9%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 21 Batch 300] ZSL test accuracy is 57.9%, Best_acc [63.4% | Epoch-3]

[Epoch 21, Batch   300] Train loss: 7.390 

 2023-05-13 23:46:36 Training epoch 22
acc_final_all:53.4% acc_final_avg:53.4%
acc_layer_all:57.5% acc_layer_avg:57.5%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 22 Batch 300] ZSL test accuracy is 57.5%, Best_acc [63.4% | Epoch-3]

[Epoch 22, Batch   300] Train loss: 7.388 

 2023-05-13 23:48:00 Training epoch 23
acc_final_all:53.9% acc_final_avg:53.9%
acc_layer_all:54.6% acc_layer_avg:54.6%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 23 Batch 300] ZSL test accuracy is 54.6%, Best_acc [63.4% | Epoch-3]

[Epoch 23, Batch   300] Train loss: 7.372 

 2023-05-13 23:49:24 Training epoch 24
acc_final_all:54.0% acc_final_avg:54.0%
acc_layer_all:55.5% acc_layer_avg:55.5%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 24 Batch 300] ZSL test accuracy is 55.5%, Best_acc [63.4% | Epoch-3]

[Epoch 24, Batch   300] Train loss: 7.368 

 2023-05-13 23:50:46 Training epoch 25
acc_final_all:53.6% acc_final_avg:53.6%
acc_layer_all:55.2% acc_layer_avg:55.2%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 25 Batch 300] ZSL test accuracy is 55.2%, Best_acc [63.4% | Epoch-3]

[Epoch 25, Batch   300] Train loss: 7.367 

 2023-05-13 23:52:04 Training epoch 26
acc_final_all:55.6% acc_final_avg:55.6%
acc_layer_all:55.5% acc_layer_avg:55.5%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 26 Batch 300] ZSL test accuracy is 55.5%, Best_acc [63.4% | Epoch-3]

[Epoch 26, Batch   300] Train loss: 7.366 

 2023-05-13 23:53:29 Training epoch 27
acc_final_all:48.7% acc_final_avg:48.7%
acc_layer_all:52.4% acc_layer_avg:52.4%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 27 Batch 300] ZSL test accuracy is 52.4%, Best_acc [63.4% | Epoch-3]

[Epoch 27, Batch   300] Train loss: 7.352 

 2023-05-13 23:54:53 Training epoch 28
acc_final_all:51.9% acc_final_avg:52.0%
acc_layer_all:53.4% acc_layer_avg:53.4%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 28 Batch 300] ZSL test accuracy is 53.4%, Best_acc [63.4% | Epoch-3]

[Epoch 28, Batch   300] Train loss: 7.353 

 2023-05-13 23:56:18 Training epoch 29
acc_final_all:52.2% acc_final_avg:52.2%
acc_layer_all:51.1% acc_layer_avg:51.1%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 29 Batch 300] ZSL test accuracy is 51.1%, Best_acc [63.4% | Epoch-3]

[Epoch 29, Batch   300] Train loss: 7.353 
Test with iou
Traceback (most recent call last):
  File "./model/main_proposal_CLIP_nn.py", line 283, in <module>
    main()
  File "./model/main_proposal_CLIP_nn.py", line 277, in main
    attri_names=data.attri_name, required_num=5,
AttributeError: 'DATA_LOADER' object has no attribute 'attri_name'
Traceback (most recent call last):
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/./model/main.py", line 6, in <module>
    import visual_utils
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/model/visual_utils.py", line 11, in <module>
    import h5py
ModuleNotFoundError: No module named 'h5py'
opt: Namespace(dataset='RSSDIVCS', root='./', image_root='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/', matdataset=True, image_embedding='res101', class_embedding='att', image_embedding_path='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat', class_embedding_path='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/ann_attr_finetune_52_splits.mat', random_id=0, preprocessing=True, standardization=False, ol=False, validation=False, batch_size=64, nepoch=30, classifier_lr=1e-06, beta1=0.5, cuda=True, pretrain_classifier='', manualSeed=3866, resnet_path='./pretrained_models/resnet101_c.pth.tar', train_id=123, pretrained=None, image_type='test_unseen_loc', pretrain_epoch=4, proto_warm=2, pretrain_lr=0.0001, gzsl=False, additional_loss=True, xe=1.0, attri=0.01, regular=0.0, l_xe=1.0, l_attri=0.08, l_regular=0.0, xe_pro=1.0, pro_type=4, attention_K=3, pro_size=3, pro_thr=1.0, pro_weight=1, pro_start_epoch=-1, cpt=1e-09, calibrated_stacking=0.7, save_att=False, IoU_scale=1.4, IoU_thr=0.5, resize_WH=False, out_of_edge=False, max_area_center=False, KNOW_BIRD_BB=False, train_mode='distributed', n_batch=300, ways=8, shots=3, transform_mode='normal', awa_finetune=False, use_group=True, avg_pool=False, sel_res='layer', all=False, use_proposal=False, version=1, attri_dim=98, lasso=False, dataroot='./data', checkpointroot='./checkpoint')
Random Seed:  3866
feature.shape (56000, 2048)
attribute.shape: torch.Size([70, 98])
Create Model...
version=1
Train and test...

 2023-11-20 21:01:37 Training epoch 0
acc_final_all:45.9% acc_final_avg:45.9%
acc_layer_all:58.5% acc_layer_avg:58.5%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 0 Batch 300] ZSL test accuracy is 58.5%, Best_acc [58.5% | Epoch-0]

[Epoch 0, Batch   300] Train loss: 7.818 

 2023-11-20 21:04:18 Training epoch 1
acc_final_all:45.2% acc_final_avg:45.2%
acc_layer_all:62.4% acc_layer_avg:62.4%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 1 Batch 300] ZSL test accuracy is 62.4%, Best_acc [62.4% | Epoch-1]

[Epoch 1, Batch   300] Train loss: 7.802 

 2023-11-20 21:07:15 Training epoch 2
acc_final_all:50.8% acc_final_avg:50.8%
acc_layer_all:61.7% acc_layer_avg:61.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 2 Batch 300] ZSL test accuracy is 61.7%, Best_acc [62.4% | Epoch-1]

[Epoch 2, Batch   300] Train loss: 7.785 

 2023-11-20 21:10:13 Training epoch 3
acc_final_all:52.4% acc_final_avg:52.4%
acc_layer_all:63.1% acc_layer_avg:63.1%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 3 Batch 300] ZSL test accuracy is 63.1%, Best_acc [63.1% | Epoch-3]

[Epoch 3, Batch   300] Train loss: 7.772 

 2023-11-20 21:13:02 Training epoch 4
acc_final_all:55.0% acc_final_avg:55.0%
acc_layer_all:59.9% acc_layer_avg:59.9%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 4 Batch 300] ZSL test accuracy is 59.9%, Best_acc [63.1% | Epoch-3]

[Epoch 4, Batch   300] Train loss: 7.755 

 2023-11-20 21:15:24 Training epoch 5
acc_final_all:60.0% acc_final_avg:60.0%
acc_layer_all:61.1% acc_layer_avg:61.1%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 5 Batch 300] ZSL test accuracy is 61.1%, Best_acc [63.1% | Epoch-3]

[Epoch 5, Batch   300] Train loss: 7.691 

 2023-11-20 21:17:19 Training epoch 6
acc_final_all:57.5% acc_final_avg:57.5%
acc_layer_all:60.7% acc_layer_avg:60.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 6 Batch 300] ZSL test accuracy is 60.7%, Best_acc [63.1% | Epoch-3]

[Epoch 6, Batch   300] Train loss: 7.618 

 2023-11-20 21:19:10 Training epoch 7
acc_final_all:57.7% acc_final_avg:57.7%
acc_layer_all:60.2% acc_layer_avg:60.2%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 7 Batch 300] ZSL test accuracy is 60.2%, Best_acc [63.1% | Epoch-3]

[Epoch 7, Batch   300] Train loss: 7.573 

 2023-11-20 21:20:59 Training epoch 8
acc_final_all:61.8% acc_final_avg:61.8%
acc_layer_all:63.7% acc_layer_avg:63.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 8 Batch 300] ZSL test accuracy is 63.7%, Best_acc [63.7% | Epoch-8]

[Epoch 8, Batch   300] Train loss: 7.538 

 2023-11-20 21:22:52 Training epoch 9
acc_final_all:59.6% acc_final_avg:59.6%
acc_layer_all:63.3% acc_layer_avg:63.3%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 9 Batch 300] ZSL test accuracy is 63.3%, Best_acc [63.7% | Epoch-8]

[Epoch 9, Batch   300] Train loss: 7.512 

 2023-11-20 21:24:49 Training epoch 10
acc_final_all:58.5% acc_final_avg:58.5%
acc_layer_all:63.3% acc_layer_avg:63.3%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 10 Batch 300] ZSL test accuracy is 63.3%, Best_acc [63.7% | Epoch-8]

[Epoch 10, Batch   300] Train loss: 7.494 

 2023-11-20 21:26:43 Training epoch 11
acc_final_all:58.6% acc_final_avg:58.6%
acc_layer_all:64.8% acc_layer_avg:64.8%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 11 Batch 300] ZSL test accuracy is 64.8%, Best_acc [64.8% | Epoch-11]

[Epoch 11, Batch   300] Train loss: 7.476 

 2023-11-20 21:28:31 Training epoch 12
acc_final_all:57.2% acc_final_avg:57.2%
acc_layer_all:62.9% acc_layer_avg:62.9%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 12 Batch 300] ZSL test accuracy is 62.9%, Best_acc [64.8% | Epoch-11]

[Epoch 12, Batch   300] Train loss: 7.462 

 2023-11-20 21:30:24 Training epoch 13
acc_final_all:55.5% acc_final_avg:55.5%
acc_layer_all:63.5% acc_layer_avg:63.5%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 13 Batch 300] ZSL test accuracy is 63.5%, Best_acc [64.8% | Epoch-11]

[Epoch 13, Batch   300] Train loss: 7.448 

 2023-11-20 21:32:22 Training epoch 14
acc_final_all:57.9% acc_final_avg:57.9%
acc_layer_all:64.3% acc_layer_avg:64.3%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 14 Batch 300] ZSL test accuracy is 64.3%, Best_acc [64.8% | Epoch-11]

[Epoch 14, Batch   300] Train loss: 7.440 

 2023-11-20 21:34:18 Training epoch 15
acc_final_all:56.0% acc_final_avg:56.0%
acc_layer_all:64.1% acc_layer_avg:64.1%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 15 Batch 300] ZSL test accuracy is 64.1%, Best_acc [64.8% | Epoch-11]

[Epoch 15, Batch   300] Train loss: 7.431 

 2023-11-20 21:36:06 Training epoch 16
acc_final_all:57.8% acc_final_avg:57.8%
acc_layer_all:64.6% acc_layer_avg:64.6%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 16 Batch 300] ZSL test accuracy is 64.6%, Best_acc [64.8% | Epoch-11]

[Epoch 16, Batch   300] Train loss: 7.423 

 2023-11-20 21:37:57 Training epoch 17
acc_final_all:55.4% acc_final_avg:55.4%
acc_layer_all:63.5% acc_layer_avg:63.5%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 17 Batch 300] ZSL test accuracy is 63.5%, Best_acc [64.8% | Epoch-11]

[Epoch 17, Batch   300] Train loss: 7.417 

 2023-11-20 21:39:55 Training epoch 18
acc_final_all:53.1% acc_final_avg:53.1%
acc_layer_all:59.5% acc_layer_avg:59.5%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 18 Batch 300] ZSL test accuracy is 59.5%, Best_acc [64.8% | Epoch-11]

[Epoch 18, Batch   300] Train loss: 7.405 

 2023-11-20 21:41:54 Training epoch 19
acc_final_all:53.8% acc_final_avg:53.8%
acc_layer_all:59.3% acc_layer_avg:59.3%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 19 Batch 300] ZSL test accuracy is 59.3%, Best_acc [64.8% | Epoch-11]

[Epoch 19, Batch   300] Train loss: 7.398 

 2023-11-20 21:43:44 Training epoch 20
acc_final_all:55.6% acc_final_avg:55.6%
acc_layer_all:61.4% acc_layer_avg:61.4%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 20 Batch 300] ZSL test accuracy is 61.4%, Best_acc [64.8% | Epoch-11]

[Epoch 20, Batch   300] Train loss: 7.402 

 2023-11-20 21:45:33 Training epoch 21
acc_final_all:53.1% acc_final_avg:53.1%
acc_layer_all:60.7% acc_layer_avg:60.7%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 21 Batch 300] ZSL test accuracy is 60.7%, Best_acc [64.8% | Epoch-11]

[Epoch 21, Batch   300] Train loss: 7.392 

 2023-11-20 21:47:30 Training epoch 22
acc_final_all:54.7% acc_final_avg:54.7%
acc_layer_all:60.2% acc_layer_avg:60.2%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 22 Batch 300] ZSL test accuracy is 60.2%, Best_acc [64.8% | Epoch-11]

[Epoch 22, Batch   300] Train loss: 7.390 

 2023-11-20 21:49:29 Training epoch 23
acc_final_all:54.2% acc_final_avg:54.2%
acc_layer_all:59.6% acc_layer_avg:59.6%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 23 Batch 300] ZSL test accuracy is 59.6%, Best_acc [64.8% | Epoch-11]

[Epoch 23, Batch   300] Train loss: 7.374 

 2023-11-20 21:51:20 Training epoch 24
acc_final_all:54.4% acc_final_avg:54.4%
acc_layer_all:59.5% acc_layer_avg:59.5%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 24 Batch 300] ZSL test accuracy is 59.5%, Best_acc [64.8% | Epoch-11]

[Epoch 24, Batch   300] Train loss: 7.369 

 2023-11-20 21:53:09 Training epoch 25
acc_final_all:53.1% acc_final_avg:53.1%
acc_layer_all:57.8% acc_layer_avg:57.8%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 25 Batch 300] ZSL test accuracy is 57.8%, Best_acc [64.8% | Epoch-11]

[Epoch 25, Batch   300] Train loss: 7.369 

 2023-11-20 21:55:04 Training epoch 26
acc_final_all:55.0% acc_final_avg:55.0%
acc_layer_all:58.9% acc_layer_avg:58.9%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 26 Batch 300] ZSL test accuracy is 58.9%, Best_acc [64.8% | Epoch-11]

[Epoch 26, Batch   300] Train loss: 7.368 

 2023-11-20 21:57:03 Training epoch 27
acc_final_all:50.7% acc_final_avg:50.7%
acc_layer_all:57.2% acc_layer_avg:57.2%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 27 Batch 300] ZSL test accuracy is 57.2%, Best_acc [64.8% | Epoch-11]

[Epoch 27, Batch   300] Train loss: 7.354 

 2023-11-20 21:58:56 Training epoch 28
acc_final_all:53.2% acc_final_avg:53.2%
acc_layer_all:57.0% acc_layer_avg:57.0%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 28 Batch 300] ZSL test accuracy is 57.0%, Best_acc [64.8% | Epoch-11]

[Epoch 28, Batch   300] Train loss: 7.355 

 2023-11-20 22:00:45 Training epoch 29
acc_final_all:51.4% acc_final_avg:51.4%
acc_layer_all:53.4% acc_layer_avg:53.4%
acc_pro_all:0.0% acc_pro_avg:0.0%
[Epoch 29 Batch 300] ZSL test accuracy is 53.4%, Best_acc [64.8% | Epoch-11]

[Epoch 29, Batch   300] Train loss: 7.355 
opt: Namespace(dataset='RSSDIVCS', root='./', image_root='/home/yzj/data/code/ISPRS/ISPRS_2023_clean/RSSDIVCS/', matdataset=True, image_embedding='res101', class_embedding='att', image_embedding_path='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat', class_embedding_path='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/ann_attr_finetune_52_splits.mat', random_id=0, preprocessing=True, standardization=False, ol=False, validation=False, batch_size=64, nepoch=30, classifier_lr=1e-06, beta1=0.5, cuda=True, pretrain_classifier='', manualSeed=3866, resnet_path='./pretrained_models/resnet101_c.pth.tar', train_id=123, pretrained=None, image_type='test_unseen_loc', pretrain_epoch=4, proto_warm=2, pretrain_lr=0.0001, gzsl=False, additional_loss=True, xe=1.0, attri=0.01, regular=0.0, l_xe=1.0, l_attri=0.08, l_regular=0.0, xe_pro=1.0, pro_type=4, attention_K=3, pro_size=3, pro_thr=1.0, pro_weight=1, pro_start_epoch=-1, cpt=1e-09, calibrated_stacking=0.7, save_att=False, IoU_scale=1.4, IoU_thr=0.5, resize_WH=False, out_of_edge=False, max_area_center=False, KNOW_BIRD_BB=False, train_mode='distributed', n_batch=300, ways=8, shots=3, transform_mode='normal', awa_finetune=False, use_group=True, avg_pool=False, sel_res='layer', all=False, use_proposal=False, version=1, attri_dim=98, lasso=False, dataroot='./data', checkpointroot='./checkpoint')
Random Seed:  3866
Traceback (most recent call last):
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 39, in _open_file
    return open(file_like, mode), True
PermissionError: [Errno 13] Permission denied: '/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/./model/main.py", line 199, in <module>
    main()
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/./model/main.py", line 40, in main
    data = visual_utils.DATA_LOADER(opt)
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/model/visual_utils.py", line 96, in __init__
    self.read_matdataset(opt)
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/model/visual_utils.py", line 173, in read_matdataset
    matcontent = sio.loadmat(opt.image_embedding_path)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 225, in loadmat
    with _open_file_context(file_name, appendmat) as f:
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/contextlib.py", line 119, in __enter__
    return next(self.gen)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 17, in _open_file_context
    f, opened = _open_file(file_like, appendmat, mode)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 45, in _open_file
    return open(file_like, mode), True
PermissionError: [Errno 13] Permission denied: '/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat'
opt: Namespace(dataset='RSSDIVCS', root='./', image_root='/home/yzj/data/code/ISPRS/ISPRS_2023_clean/RSSDIVCS/', matdataset=True, image_embedding='res101', class_embedding='att', image_embedding_path='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat', class_embedding_path='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/ann_attr_finetune_52_splits.mat', random_id=0, preprocessing=True, standardization=False, ol=False, validation=False, batch_size=64, nepoch=30, classifier_lr=1e-06, beta1=0.5, cuda=True, pretrain_classifier='', manualSeed=3866, resnet_path='./pretrained_models/resnet101_c.pth.tar', train_id=123, pretrained=None, image_type='test_unseen_loc', pretrain_epoch=4, proto_warm=2, pretrain_lr=0.0001, gzsl=False, additional_loss=True, xe=1.0, attri=0.01, regular=0.0, l_xe=1.0, l_attri=0.08, l_regular=0.0, xe_pro=1.0, pro_type=4, attention_K=3, pro_size=3, pro_thr=1.0, pro_weight=1, pro_start_epoch=-1, cpt=1e-09, calibrated_stacking=0.7, save_att=False, IoU_scale=1.4, IoU_thr=0.5, resize_WH=False, out_of_edge=False, max_area_center=False, KNOW_BIRD_BB=False, train_mode='distributed', n_batch=300, ways=8, shots=3, transform_mode='normal', awa_finetune=False, use_group=True, avg_pool=False, sel_res='layer', all=False, use_proposal=False, version=1, attri_dim=98, lasso=False, dataroot='./data', checkpointroot='./checkpoint')
Random Seed:  3866
Traceback (most recent call last):
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 39, in _open_file
    return open(file_like, mode), True
PermissionError: [Errno 13] Permission denied: '/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/./model/main.py", line 199, in <module>
    main()
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/./model/main.py", line 40, in main
    data = visual_utils.DATA_LOADER(opt)
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/model/visual_utils.py", line 96, in __init__
    self.read_matdataset(opt)
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/model/visual_utils.py", line 173, in read_matdataset
    matcontent = sio.loadmat(opt.image_embedding_path)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 225, in loadmat
    with _open_file_context(file_name, appendmat) as f:
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/contextlib.py", line 119, in __enter__
    return next(self.gen)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 17, in _open_file_context
    f, opened = _open_file(file_like, appendmat, mode)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 45, in _open_file
    return open(file_like, mode), True
PermissionError: [Errno 13] Permission denied: '/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat'
opt: Namespace(dataset='RSSDIVCS', root='./', image_root='/home/yzj/data/code/ISPRS/ISPRS_2023_clean/RSSDIVCS/', matdataset=True, image_embedding='res101', class_embedding='att', image_embedding_path='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat', class_embedding_path='/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/ann_attr_finetune_52_splits.mat', random_id=0, preprocessing=True, standardization=False, ol=False, validation=False, batch_size=64, nepoch=30, classifier_lr=1e-06, beta1=0.5, cuda=True, pretrain_classifier='', manualSeed=3866, resnet_path='./pretrained_models/resnet101_c.pth.tar', train_id=123, pretrained=None, image_type='test_unseen_loc', pretrain_epoch=4, proto_warm=2, pretrain_lr=0.0001, gzsl=False, additional_loss=True, xe=1.0, attri=0.01, regular=0.0, l_xe=1.0, l_attri=0.08, l_regular=0.0, xe_pro=1.0, pro_type=4, attention_K=3, pro_size=3, pro_thr=1.0, pro_weight=1, pro_start_epoch=-1, cpt=1e-09, calibrated_stacking=0.7, save_att=False, IoU_scale=1.4, IoU_thr=0.5, resize_WH=False, out_of_edge=False, max_area_center=False, KNOW_BIRD_BB=False, train_mode='distributed', n_batch=300, ways=8, shots=3, transform_mode='normal', awa_finetune=False, use_group=True, avg_pool=False, sel_res='layer', all=False, use_proposal=False, version=1, attri_dim=98, lasso=False, dataroot='./data', checkpointroot='./checkpoint')
Random Seed:  3866
Traceback (most recent call last):
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 39, in _open_file
    return open(file_like, mode), True
PermissionError: [Errno 13] Permission denied: '/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/./model/main.py", line 199, in <module>
    main()
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/./model/main.py", line 40, in main
    data = visual_utils.DATA_LOADER(opt)
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/model/visual_utils.py", line 96, in __init__
    self.read_matdataset(opt)
  File "/home/yzj/data/code/ISPRS/ISPRS_2023_clean/code/model/visual_utils.py", line 173, in read_matdataset
    matcontent = sio.loadmat(opt.image_embedding_path)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 225, in loadmat
    with _open_file_context(file_name, appendmat) as f:
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/contextlib.py", line 119, in __enter__
    return next(self.gen)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 17, in _open_file_context
    f, opened = _open_file(file_like, appendmat, mode)
  File "/home/yzj/data/anaconda3/envs/zsl/lib/python3.9/site-packages/scipy/io/matlab/_mio.py", line 45, in _open_file
    return open(file_like, mode), True
PermissionError: [Errno 13] Permission denied: '/home/xwj/data/2023_code/RS_ZSL/ISPRS_2023_clean/RSSDIVCS/files/52_images.mat'
